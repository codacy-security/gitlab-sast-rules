# yamllint disable
# License: MIT (c) GitLab Inc.
# yamllint enable
---
rules:
- id: "java/xss/rule-XSSServlet"
  patterns:
  - pattern-inside: |-
      $TYPE $FUNC(..., HttpServletResponse $RESP, ...) { ... }
  - pattern-inside: |-
      $TYPE $FUNC(..., HttpServletRequest $REQ, ...) { ... }
  - pattern-inside: |-
      $PARAM_VAL = $REQ.getParameter(...); ...
  - pattern-either:
    - pattern: "$RESP.getWriter(...).write(..., $PARAM_VAL, ...);"
    - pattern: |
        $WR = $RESP.getWriter(...);
        ...
        $WR.write(..., $PARAM_VAL, ...);
  message: |
    A potential XSS was found. It could be used to execute unwanted JavaScript in a
    client's browser.
  languages:
  - "java"
  metadata:
    cwe: "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site
      Scripting')"
    owasp: "A7: Cross-Site Scripting (XSS)"
    # yamllint disable
    source-rule-url: "https://find-sec-bugs.github.io/bugs.htm#XSS_SERVLET"
    # yamllint enable
    category: "security"
    confidence: "HIGH"
  severity: "ERROR"
