# yamllint disable
# License: MIT (c) GitLab Inc.
# yamllint enable
---
rules:
- id: "java/cookie/rule-CookiePersistent"
  patterns:
  - pattern-inside: |
      (javax.servlet.http.Cookie $C).setMaxAge($AGE);
  - metavariable-comparison:
      metavariable: "$AGE"
      comparison: "$AGE >= 31536000"
  message: |
    "A new cookie is created without the Secure flag set. The Secure flag is a directive to the
    browser to make sure that the cookie is not sent for insecure communication (http://)"
  languages:
  - "java"
  severity: "WARNING"
  metadata:
    category: "security"
    cwe: "CWE-614: Sensitive Cookie in HTTPS Session Without 'Secure' Attribute"
    additional-cwe:
    - "CWE-315: Cleartext Storage of Sensitive Information in a Cookie"
    - "CWE-311: Missing Encryption of Sensitive Data"
    # yamllint disable
    source-rule-url: "https://find-sec-bugs.github.io/bugs.htm#INSECURE_COOKIE"
    # yamllint enable
    technology:
    - "java"
