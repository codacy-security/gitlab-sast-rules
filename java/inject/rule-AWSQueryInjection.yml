# yamllint disable
# License: MIT (c) GitLab Inc.
# yamllint enable
---
rules:
- id: "java/inject/rule-AWSQueryInjection"
  patterns:
  - pattern-either:
    - pattern: |
        $QUERY = ... + $VAR + ...;
        ...
        $REQ = new SelectRequest($QUERY, ...);
        ...
        (AmazonSimpleDB $DB).select($REQ);
    - pattern: |
        $QUERY = ... + $VAR + ...;
        ...
        (AmazonSimpleDB $DB).select(new SelectRequest($QUERY,...));
  message: |
    "Constructing SimpleDB queries containing user input can allow an attacker to view unauthorized
    records."
  languages:
  - "java"
  severity: "ERROR"
  metadata:
    category: "security"
    cwe: "CWE-943: Improper Neutralization of Special Elements in Data Query Logic"
    # yamllint disable
    source-rule-url: "https://find-sec-bugs.github.io/bugs.htm#AWS_QUERY_INJECTION"
    # yamllint enable
    technology:
    - "java"
