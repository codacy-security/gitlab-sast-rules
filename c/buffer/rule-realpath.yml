# yamllint disable
# The ruleset is generated from flawfinder official rule repository hosted on github.
# License: GPL 2.0 (c) 1989, 1991 Free Software Foundation, Inc.
# source: https://github.com/david-a-wheeler/flawfinder/blob/e0d8827c3b714a883ce8036edc832721f4619524/flawfinder.py
# yamllint enable
---
rules:
- id: "c/buffer/rule-realpath"
  languages:
  - "c"
  message: "The `realpath` function should not be called with a destination buffer
    as it could\nlead to overflowing if the path is greater than PATH_LEN. It is instead
    recommended\nto call `realpath` with the destination buffer set to NULL and use
    the return value\nas the resolved path. Be sure to free the returned pointer as
    realpath will allocate\nthe buffer internally using `malloc`. \n\nFor more information
    see: https://man7.org/linux/man-pages/man3/realpath.3.html.\n\nExample:\n\n```\nchar
    const *symlink_path = \"/tmp/symlink\";\nchar *resolved_path = NULL;\n\nresolved_path
    = realpath(symlink_path, NULL);\nif (errno == 0) {\n  // ... use resolved_path...\n
    \ free(resolved_path);\n}\n``` \n"
  metadata:
    shortDescription: "Function does not ensure destination buffer length is sufficient
      before copying"
    cwe: "CWE-120"
  pattern: "realpath(...)"
  severity: "WARNING"
