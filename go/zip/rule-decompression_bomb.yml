# yamllint disable
# License: Apache 2.0 (c) gosec
# source (original): https://github.com/securego/gosec/blob/master/rules/decompression-bomb.go
# hash: c6e10af 
# yamllint enable
---
rules:
- id: "go/zip/rule-decompression_bomb"
  patterns:
  - pattern-either:
    - pattern: "io.Copy(...)"
    - pattern: "io.CopyBuffer(...)"
  - pattern-either:
    - pattern-inside: |
        gzip.NewReader(...)
        ...
    - pattern-inside: |
        zlib.NewReader(...)
        ...
    - pattern-inside: |
        bzip2.NewReader(...)
        ...
    - pattern-inside: |
        flate.NewReader(...)
        ...
    - pattern-inside: |
        lzw.NewReader(...)
        ...
    - pattern-inside: |
        tar.NewReader(...)
        ...
    - pattern-inside: |
        zip.NewReader(...)
        ...
    - pattern-inside: |
        zlib.NewReaderDict(...)
        ...
    - pattern-inside: |
        flate.NewReaderDict(...)
        ...
    - pattern-inside: |
        zip.OpenReader(...)
        ...
  message: |
    Potential DoS vulnerability via decompression bomb
  metadata:
    cwe: "CWE-409: Improper Handling of Highly Compressed Data"
  severity: "WARNING"
  languages:
  - "go"
