# yamllint disable
# maps spotbugs rule ids to semgrep rules
# License: MIT (c) GitLab Inc.
# yamllint enable
---
find_sec_bugs:
  
  # random
  - id: "PREDICTABLE_RANDOM"
    rules:
      - "java/random/rule-PseudoRandom"
  
  # XSS
  - id: "XSS_SERVLET"
    rules:
      - "java/xss/rule-XSSServlet"
      - "java/xss/rule-XSSServletParameter"
  - id: "XSS_SERVLET_PARAMETER"
    rules:
      - "java/xss/rule-XSSServletParameter"
  - id: "XSS_REQUEST_PARAMETER_TO_SERVLET_WRITER"
    rules:
      - "java/xss/rule-XSSReqParamToServletWriter"
  
  # Strings
  - id: "NORMALIZATION_AFTER_VALIDATION"
    rules:
      - "java/strings/rule-NormalizeAfterValidation"
  - id: "MODIFICATION_AFTER_VALIDATION"
    rules:
      - "java/strings/rule-ModifyAfterValidation"
  - id: "IMPROPER_UNICODE"
    rules:
      - "java/strings/rule-ImproperUnicode"
  - id: "BAD_HEXA_CONVERSION"
    rules:
      - "java/strings/rule-BadHexConversion"
  
  # Permissions 
  - id: "DANGEROUS_PERMISSION_COMBINATION"
    rules:
      - "java/perm/rule-DangerousPermissions"
  - id: "OVERLY_PERMISSIVE_FILE_PERMISSION"
    rules:
      - "java/perm/rule-OverlyPermissiveFilePermissionInline"
      - "java/perm/rule-OverlyPermissiveFilePermissionObj"
  - id: "FORMAT_STRING_MANIPULATION"
    rules:
      - "java/strings/rule-FormatStringManipulation"

  # XML 
  - id: "SAML_IGNORE_COMMENTS"
    rules:
      - "java/xml/rule-SAMLIgnoreComments"
  - id: "RPC_ENABLED_EXTENSIONS"
    rules:
      - "java/xml/rule-ApacheXmlRpc"

  # Injections    
  - id: "AWS_QUERY_INJECTION"
    rules: 
      - "java/inject/rule-AWSQueryInjection"
  - id: "BEAN_PROPERTY_INJECTION"
    rules: 
      - "java/inject/rule-BeanPropertyInjection"
  - id: "COMMAND_INJECTION"
    rules: 
      - "java/inject/rule-CommandInjection"
  - id: "CRLF_INJECTION_LOGS"
    rules: 
      - "java/inject/rule-CLRFInjectionLogs"
  - id: "CUSTOM_INJECTION"
    rules: 
      - "java/inject/rule-CustomInjection"
      - "java/inject/rule-CustomInjectionSQLString"
  - id: "EL_INJECTION"
    rules: 
      - "java/inject/rule-ELInjection"
  - id: "REQUESTDISPATCHER_FILE_DISCLOSURE"
    rules: 
      - "java/inject/rule-FileDisclosure"
  
  # Cryptography
  - id: "BLOWFISH_KEY_SIZE"
    rules: 
      - "java/crypto/rule-BlowfishKeySize"
  - id: "CIPHER_INTEGRITY"
    rules: 
      - "java/crypto/rule-CipherIntegrity"
  - id: "ECB_MODE"
    rules: 
      - "java/crypto/rule-CipherECBMode"
  - id: "PADDING_ORACLE"
    rules: 
      - "java/crypto/rule-CipherPaddingOracle"
  - id: "CUSTOM_MESSAGE_DIGEST"
    rules: 
      - "java/crypto/rule-CustomMessageDigest"
  - id: "DEFAULT_HTTP_CLIENT"
    rules: 
      - "java/crypto/rule-DefaultHTTPClient"
  - id: "DES_USAGE"
    rules: 
      - "java/crypto/rule-CipherDESInsecure"
  - id: "TDES_USAGE"
    rules: 
      - "java/crypto/rule-CipherDESedeInsecure"
  - id: "RSA_KEY_SIZE"
    rules: 
      - "java/crypto/rule-InsufficientKeySizeRsa"
  - id: "RSA_NO_PADDING"
    rules:
      - "java/crypto/rule-RsaNoPadding"
  
  # Cookie
  - id: "COOKIE_PERSISTENT"
    rules: 
      - "java/cookie/rule-CookiePersistent"
  - id: "INSECURE_COOKIE"
    rules: 
      - "java/cookie/rule-CookieInsecure"
  - id: "HTTPONLY_COOKIE"
    rules: 
      - "java/cookie/rule-CookieHTTPOnly"
  - id: "COOKIE_USAGE"
    rules: 
      - "java/cookie/rule-CookieUsage"
  
  # Password
  - id: "DMI_EMPTY_DB_PASSWORD"
    rules:
      - "java/password/rule-EmptyDBPassword"
  - id: "DMI_CONSTANT_DB_PASSWORD"
    rules:
      - "java/password/rule-ConstantDBPassword"
  - id: "HARD_CODE_KEY"
    rules:
      - "java/password/rule-HardcodeKey"
      - "java/password/rule-HardcodeKeySuspiciousName"
      - "java/password/rule-HardcodeKeySuspiciousValue"
      - "java/password/rule-HardcodeKeyEquals"
  - id: "HARD_CODE_PASSWORD"
    rules:
      - "java/password/rule-HardcodePassword"
      - "java/password/rule-EmptyDBPassword"
      - "java/password/rule-ConstantDBPassword"

  # Unsafe
  - id: "EXTERNAL_CONFIG_CONTROL"
    rules:
      - "java/unsafe/rule-ExternalConfigControl"

  # File
  - id: "FILE_UPLOAD_FILENAME"
    rules:
      - "java/file/rule-FileUploadFileName"

  # Script
  - id: "SCRIPT_ENGINE_INJECTION"
    rules:
      - "java/script/rule-ScriptInjection"

  - id: "SPEL_INJECTION"
    rules:
      - "java/script/rule-ScriptInjection"

  - id: "EL_INJECTION"
    rules:
      - "java/script/rule-ScriptInjection"

  - id: "SEAM_LOG_INJECTION"
    rules:
      - "java/script/rule-ScriptInjection"

  - id: "OGNL_INJECTION"
    rules:
      - "java/script/rule-ScriptInjection"

  # Servlet
  - id: "SERVLET_PARAMETER" 
    rules:
      - "java/endpoint/rule-InsecureServlet"

  - id: "SERVLET_CONTENT_TYPE"
    rules:
      - "java/endpoint/rule-InsecureServlet"

  - id: "SERVLET_SERVER_NAME"
    rules:
      - "java/endpoint/rule-InsecureServlet"

  - id: "SERVLET_SESSION_ID" 
    rules:
      - "java/endpoint/rule-InsecureServlet"

  - id: "SERVLET_QUERY_STRING" 
    rules:
      - "java/endpoint/rule-InsecureServlet"

  - id: "SERVLET_HEADER"
    rules:
      - "java/endpoint/rule-InsecureServlet"

  - id: "SERVLET_HEADER_REFERER"  
    rules:
      - "java/endpoint/rule-InsecureServlet"

  - id: "SERVLET_HEADER_USER_AGENT"
    rules:
      - "java/endpoint/rule-InsecureServlet"
