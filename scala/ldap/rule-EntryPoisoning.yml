# yamllint disable
# License: MIT (c) GitLab Inc.
# yamllint enable
---
rules:
- id: "scala/ldap/rule-EntryPoisoning"
  pattern-either:
  - pattern: "new SearchControls($SCOPE, $CLIMIT, $TLIMIT, $ATTR, true, $DEREF)"
  - pattern: |
      val $CTRL = new SearchControls(...)
      ...
      $CTRL.setReturningObjFlag(true)
  languages:
  - "scala"
  message: |
    Without proper access control, executing an LDAP statement that contains a
    user-controlled value can allow an attacker to abuse poorly configured LDAP
    context
  metadata:
    category: "security"
    cwe: "CWE-20: Improper Input Validation"
  severity: "ERROR"
