# yamllint disable
# License: MIT (c) GitLab Inc.
# yamllint enable
---
rules:
- id: "scala/xss/rule-XSSReqParamToServletWriter"
  mode: "taint"
  pattern-sources:
  - patterns:
    - pattern-inside: |-
        def $FUNC(..., $REQ: HttpServletRequest, ...): $TYPE = {...}
    - pattern-either:
      - pattern: "$REQ.getParameter(...)"
      - pattern: "$REQ.getQueryString"
  pattern-sanitizers:
  - pattern: "Encode.forHtml(...)"
  - pattern: "org.owasp.esapi.Encoder.encodeForSQL(...)"
  pattern-sinks:
  - patterns:
    - pattern-inside: |-
        def $FUNC(..., $RES: HttpServletResponse, ...): $TYPE = {...}
    - pattern-inside: |
        $WRITER = $RES.getWriter
        ...
    - pattern: "$WRITER.write(...)"
  - patterns:
    - pattern-inside: |-
        def $FUNC(..., $RES: HttpServletResponse, ...): $TYPE = {...}
    - pattern: "$RES.getWriter.write(...)"
  - patterns:
    - pattern-inside: |-
        def $FUNC(..., $RES: HttpServletResponse, ...): $TYPE = {...}
    - pattern: "$RES.getWriter.print(...)"
  message: |
    Servlet reflected cross site scripting vulnerability
  languages:
  - "scala"
  severity: "WARNING"
  metadata:
    cwe: "CWE-79: Improper Neutralization of Input During Web Page Generation"
    category: "security"
    technology:
    - "scala"
