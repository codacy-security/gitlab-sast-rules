# yamllint disable
# License: MIT (c) GitLab Inc.
# yamllint enable
---
rules:
- id: "python_exec_rule-start-process-with-no-shell"
  languages:
  - "python"
  message: |
    Found dynamic content when spawning a process. This is dangerous if externaldata can reach this
    function call because it allows a malicious actor toexecute commands. Ensure no external data
    reaches here.
  metadata:
    cwe: "CWE-78"
    owasp: "A1:2017-Injection"
    shortDescription: "Improper Neutralization of Special Elements used in an OS Command
      ('OS Command Injection')"
  patterns:
  - pattern-not: os.$FUNC("...", ...)
  - pattern: os.$FUNC(<...$VAL...>, ...)
  - metavariable-pattern:
      metavariable: $FUNC
      pattern-either:
      - pattern: execl
      - pattern: execle
      - pattern: execlp
      - pattern: execlpe
      - pattern: execv
      - pattern: execve
      - pattern: execvp
      - pattern: execvpe
      - pattern: spawnl
      - pattern: spawnle
      - pattern: spawnlp
      - pattern: spawnlpe
      - pattern: spawnv
      - pattern: spawnve
      - pattern: spawnvp
      - pattern: spawnvpe
      - pattern: startfile
  severity: "WARNING"
