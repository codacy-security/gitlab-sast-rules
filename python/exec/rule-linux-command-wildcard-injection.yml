# yamllint disable
# License: MIT (c) GitLab Inc.
# yamllint enable
---
rules:
- id: "python_exec_rule-linux-command-wildcard-injection"
  languages:
  - "python"
  message: |
    Detected use of the wildcard character in a system call that spawns a shell.This subjects the
    wildcard to normal shell expansion, which can have unintended consequencesif there exist any
    non-standard file names. Consider a file named `-e sh script.sh`.
  metadata:
    cwe: "CWE-155"
    owasp: "A1:2017-Injection"
    shortDescription: "Improper Neutralization of Wildcards or Matching Symbols"
    patterns:
      - pattern-either:
          - pattern: os.system("$ARG")
          - pattern: os.popen("$ARG")
          - pattern: os.popen2("$ARG")
          - pattern: os.popen3("$ARG")
          - pattern: os.popen4("$ARG")
          - pattern: popen2.Popen3("$ARG")
          - pattern: popen2.Popen4("$ARG")
          - pattern: commands.getoutput("$ARG")
          - pattern: commands.getstatusoutput("$ARG")
          - pattern: subprocess.Popen("$ARG", ...,shell=True,...)
          - pattern: subprocess.call("$ARG")
          - pattern: os.execl("$ARG")
          - pattern: os.execle("$ARG")
      - metavariable-regex:
          metavariable: $ARG
          regex: .*(chown|chmod|tar|rsync)(.*)+\*
  severity: "WARNING"
