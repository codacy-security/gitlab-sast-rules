rules:
- id: bandit.B103
  patterns:
    - pattern: os.chmod(...,$MASK)
    - metavariable-regex:
        metavariable: "$MASK"
        regex: "(0x..f|0o..[2,3,7]|stat.S_IXGRP|stat.S_IWOTH)"
  message: 'Chmod setting a permissive mask on file.'
  metadata:
    cwe: 'CWE-732: Incorrect Permission Assignment for Critical Resource'
    owasp: 'A6: Security Misconfiguration'
  severity: WARNING
  languages: [python]
# source (original): https://github.com/returntocorp/semgrep-rules/blob/develop/python/lang/security/audit/network/bind.yaml
# avoid-bind-to-all-interfaces
