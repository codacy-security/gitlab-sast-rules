# yamllint disable
# source (original): https://github.com/returntocorp/semgrep-rules/blob/develop/python/lang/security/audit/system-wildcard-detected.yaml
# system-wildcard-detected
# yamllint enable
---
rules:
- id: "bandit.B609"
  patterns:
  - pattern-either:
    - pattern-inside: |-
        os.system("...")
    - pattern-inside: |-
        os.popen("...")
    - pattern-inside: |-
        os.popen2("...")
    - pattern-inside: |-
        os.popen3("...")
    - pattern-inside: |-
        os.popen4("...")
    - pattern-inside: |-
        subprocess.$W(..., shell=True, ...)
  - pattern-regex: "(tar|chmod|chown|rsync)(.*?)\\*"
  message: |
    Detected use of the wildcard character in a system call that spawns a shell.This subjects the
    wildcard to normal shell expansion, which can have unintended consequencesif there exist any
    non-standard file names. Consider a file named '-e sh script.sh' -- thiswill execute a script
    when
    'rsync' is called.
    Seehttps://www.defensecode.com/public/DefenseCode_Unix_WildCards_Gone_Wild.txtfor
    more information.
  metadata:
    cwe: "CWE-155: Improper Neutralization of Wildcards or Matching Symbols"
    owasp: "A1: Injection"
  severity: "WARNING"
  languages:
  - "python"
