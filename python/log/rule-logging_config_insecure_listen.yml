# yamllint disable
# License: MIT (c) GitLab Inc.
# yamllint enable
---
rules:
- id: "python/log/rule-logging_config_insecure_listen"
  languages:
  - "python"
  message: |
    The logging.config.listen function provides the ability to listen for external configuration
    files on a socket server. Because portions of the configuration are passed through eval(), use
    of this function may open its users to a security risk. While the function only binds to a
    socket on localhost, and so does not accept connections from remote machines, there are
    scenarios where untrusted code could be run under the account of the process which calls
    listen(). logging.config.listen provides the ability to verify bytes received across the socket
    with signature verification or encryption/decryption.
  metadata:
    cwe: "CWE-94"
    shortDescription: "Improper Control of Generation of Code ('Code Injection')"
  patterns:
  - pattern: "logging.config.listen(...)"
  severity: "WARNING"
