# yamllint disable
# License: MIT (c) GitLab Inc.
# yamllint enable
---
rules:
- id: "python/xml/rule-expatreader"
  languages:
  - "python"
  message: |
    Insecure XML parsing functionality, prefer `defusedxml`
  metadata:
    cwe: "CWE-611"
    owasp: "A4:2017-XML External Entities (XXE)"
    shortDescription: "Improper Restriction of XML External Entity Reference"
  pattern-either:
  - pattern: "xml.dom.expatreader.parse(...)"
  - patterns:
    - pattern: "xml.dom.expatreader.parseString(...)"
    - pattern-not: "xml.dom.expatreader.parseString(\"...\")"
  - pattern: "xml.dom.expatreader.parseString(...)"
  - pattern: "xml.dom.expatreader.create_parser(...)"
  severity: "WARNING"
